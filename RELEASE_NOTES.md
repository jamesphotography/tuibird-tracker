# 🦅 慧眼找鸟 - 版本发布记录

## v0.4.2 (2025-11-05) - 特有种标识与用户体验优化

### ✨ 新功能

#### 🦘 特有种鸟类标识系统
- **智能徽章显示**：在报告中自动标识每个国家/地区的特有鸟种
- **直观图标**：使用emoji代表不同国家（🦘澳洲、🥝新西兰、🦜印尼/菲律宾等）
- **简洁设计**：徽章格式从"🦘 澳大利亚特有"优化为"🦘特有"，节省空间
- **多国支持**：支持跨国家特有种显示（如🦘🥝特有）

#### 🔄 加载动画系统
- **全屏加载遮罩**：查询时显示半透明遮罩层，防止误操作
- **旋转加载圈**：CSS动画实现的流畅加载指示器
- **动态提示文本**：根据查询类型显示不同提示
  - 物种追踪：显示追踪的物种数量和名称
  - 区域查询：显示搜索半径和时间范围
- **渐入动画效果**：优雅的淡入淡出过渡

### 🎨 用户界面优化

- **特有种徽章简化**：文字从"国家名+特有"简化为"特有"两字
- **加载状态反馈**：所有查询操作都有明确的视觉反馈
- **毛玻璃背景**：加载遮罩层支持backdrop-filter效果

### 🐛 问题修复

- **数据完整性**：补充endemic_birds数据库中缺失的Western Grasswren（西草鹩莺）
- **数据传递bug**：修复region_query报告中特有种信息未正确传递的问题

### 📚 技术改进

#### 数据库层 (database.py)
```python
def load_endemic_birds_map() -> Dict[str, List[Dict]]
    # 一次性加载全部特有种到内存（~3,000条记录）
    # O(1) 查找时间复杂度

def get_endemic_info(scientific_name: str, endemic_map: Dict) -> Optional[List[Dict]]
    # 快速查询某个物种是否为特有种
```

#### Web应用层 (web_app.py)
- 启动时加载`endemic_birds_map`全局缓存
- API路由集成endemic info查询
- 报告生成时自动附加特有种徽章

#### 前端层
- **CSS**: 新增loading-overlay、loading-spinner等样式
- **JavaScript**: 实现showLoading()和hideLoading()函数
- **HTML**: 在base.html添加全局加载动画容器

### 🗃️ 数据库更新

- **endemic_birds表**: 从3,183条增加到3,184条记录
- **新增物种**: Amytornis textilis（西草鹩莺/Western Grasswren）

### 📊 性能指标

- **特有种查询**: O(1)时间复杂度（内存缓存）
- **内存占用**: ~0.6MB（3,184条特有种记录）
- **加载动画**: 流畅60fps CSS动画

---

## v0.4.1 (2025-11-04) - 性能优化与功能增强

### ⚡ 性能优化

#### RateLimiter系统重构
- **内存缓存模式**: 所有限流状态存储在内存中
- **定时持久化**: 每30秒自动保存到磁盘
- **并发安全**: 使用线程锁保护共享资源
- **性能提升**: 查询速度提升95%+

#### 地理编码缓存
- **LRU Cache**: 最近最少使用策略
- **持久化存储**: 缓存数据保存到JSON文件
- **智能优先级**: 优先搜索澳洲，自动扩展全球
- **缓存命中率**: >80%

### 🎯 功能增强

- **国家列表排序**: 按中文拼音排序，澳洲固定首位
- **数据分组优化**: api_track()按鸟种分组，提升可读性
- **报告文件命名**: 包含时间戳，避免覆盖

---

## v0.4.0 及更早版本

请查看Git提交历史获取详细信息。

---

## 路线图 🗺️

### 计划中的功能
- [ ] 特有种浏览页面（按大洲/国家分组）
- [ ] 更多国家的特有种数据补充
- [ ] 离线模式支持
- [ ] 导出功能（PDF/Excel）
- [ ] 多语言支持

### 正在开发
- [ ] 路线规划功能
- [ ] 高级筛选器

---

**注**: 本项目使用 [语义化版本](https://semver.org/lang/zh-CN/) 管理版本号。
